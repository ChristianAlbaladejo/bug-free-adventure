(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{UrDz:function(e,t,n){"use strict";n.r(t),n.d(t,"RegisterPageModule",(function(){return p}));var r=n("ofXK"),o=n("3Pt+"),i=n("TEn/"),a=n("tyNb"),l=n("mrSG"),s=n("qfBg"),d=n("2hxB"),g=n("fXoL");function c(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"span"),g["\u0275\u0275element"](1,"br"),g["\u0275\u0275text"](2," El email es incorrecto"),g["\u0275\u0275elementEnd"]())}const m=[{path:"",component:(()=>{class e{constructor(e,t,n,r,o){this.navCtrl=e,this._userService=t,this.loadingController=n,this.alertController=r,this.toastController=o,this.validateStreet=!1,this.formattedaddress=" ",this.options={componentRestrictions:{country:["ES"]}}}AddressChange(e){this.validateStreet=!1,console.log(this.validateStreet,e),"input"!=e&&(this.formattedaddress=e.formatted_address,this.getDistanciaMetros(e.geometry.location.lat(),e.geometry.location.lng(),37.804516,-.831246)?(this.formattedaddress="Podemos repartir",this.validateStreet=!0,this.user.calle=e.formatted_address):(this.formattedaddress="Lo sentimos no podemos repartir a esa direcci\xf3n",this.user.calle="",this.validateStreet=!1))}ngOnInit(){this.user=new d.a("","","","","","","","","")}register(){return Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.loadingController.create({message:"Cargando...",translucent:!0});yield e.present(),this.ifLogin&&localStorage.clear(),this.user.password==this.password2?this._userService.register(this.user).subscribe(e=>Object(l.a)(this,void 0,void 0,(function*(){console.log(e),"El usuario ya existe!!"!=e.message?this._userService.login(this.user).subscribe(e=>{this.identity=e.user,this.token=e.token,localStorage.setItem("identity",JSON.stringify(this.identity)),localStorage.setItem("token",this.token),this.loadingController.dismiss(),this.navCtrl.navigateForward("/home")},e=>Object(l.a)(this,void 0,void 0,(function*(){console.error(e),this.loadingController.dismiss(),this.navCtrl.navigateForward("/login")}))):(this.loadingController.dismiss(),(yield this.toastController.create({message:"Esta cuenta ya existe",duration:2e3,color:"danger"})).present())})),e=>Object(l.a)(this,void 0,void 0,(function*(){this.loadingController.dismiss(),(yield this.toastController.create({message:"Error al registrar su cuenta",duration:2e3,color:"danger"})).present()}))):((yield this.toastController.create({message:"La contrase\xf1a no es la misma",duration:2e3,color:"danger"})).present(),this.loadingController.dismiss())}))}getDistanciaMetros(e,t,n,r){const o=function(e){return e*Math.PI/180};var i=o(n-e),a=o(r-t),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o(e))*Math.cos(o(n))*Math.sin(a/2)*Math.sin(a/2),s=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6378.137;return console.log(s),s<=8}ifLogin(){return null==JSON.parse(localStorage.getItem("identity"))}}return e.\u0275fac=function(t){return new(t||e)(g["\u0275\u0275directiveInject"](i.Q),g["\u0275\u0275directiveInject"](s.a),g["\u0275\u0275directiveInject"](i.O),g["\u0275\u0275directiveInject"](i.b),g["\u0275\u0275directiveInject"](i.X))},e.\u0275cmp=g["\u0275\u0275defineComponent"]({type:e,selectors:[["app-register"]],features:[g["\u0275\u0275ProvidersFeature"]([s.a])],decls:36,vars:12,consts:[[3,"translucent"],["slot","start"],[1,"login"],["padding","",1,"login-box"],["novalidate","",3,"ngSubmit"],["registerForm","ngForm"],["placeholder","Email","name","email","type","email","required","","pattern","[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$",3,"ngModel","ngModelChange"],["email","ngModel"],[4,"ngIf"],["type","text","id","nombre","name","login","placeholder","Nombre","required","",3,"ngModel","ngModelChange"],["type","text","id","apellidos","name","login","placeholder","Apellidos","required","",3,"ngModel","ngModelChange"],["type","text","id","cif","name","login","placeholder","NIF","required","",3,"ngModel","ngModelChange"],["type","text","name","location","id","calle","aria-describedby","direccionHelp","placeholder","Calle","required","",3,"ngModel","ngModelChange","input","onAddressChange"],["type","text","id","tel\xe9fono","name","login","placeholder","Telefono","required","",3,"ngModel","ngModelChange"],["type","text","id","cp","name","login","placeholder","CP","required","",3,"ngModel","ngModelChange"],["type","text","id","poblacion","name","login","placeholder","Poblaci\xf3n","required","",3,"ngModel","ngModelChange"],["type","password","id","password","name","login","placeholder","Contrase\xf1a","required","",3,"ngModel","ngModelChange"],["type","password","id","password2","name","login","placeholder","Repite la contrase\xf1a","required","",3,"ngModel","ngModelChange"],["type","submit","color","primary","block","",1,"login-register"],["routerLink","../login","color","primary","block","",1,"login-register"]],template:function(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"ion-header",0),g["\u0275\u0275elementStart"](1,"ion-toolbar"),g["\u0275\u0275elementStart"](2,"ion-buttons",1),g["\u0275\u0275element"](3,"ion-menu-button"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](4,"ion-title"),g["\u0275\u0275text"](5,"Registrate"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](6,"ion-content",2),g["\u0275\u0275elementStart"](7,"ion-card",3),g["\u0275\u0275elementStart"](8,"form",4,5),g["\u0275\u0275listener"]("ngSubmit",(function(){return t.register()})),g["\u0275\u0275elementStart"](10,"ion-item"),g["\u0275\u0275elementStart"](11,"ion-input",6,7),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.email=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](13,c,3,0,"span",8),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](14,"ion-item"),g["\u0275\u0275elementStart"](15,"ion-input",9),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.name=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](16,"ion-item"),g["\u0275\u0275elementStart"](17,"ion-input",10),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.lastname=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](18,"ion-item"),g["\u0275\u0275elementStart"](19,"ion-input",11),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.CIF=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](20,"ion-item"),g["\u0275\u0275elementStart"](21,"ion-input",12),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.calle=e}))("input",(function(){return t.AddressChange("input")}))("onAddressChange",(function(e){return t.AddressChange(e)})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](22,"ion-item"),g["\u0275\u0275elementStart"](23,"ion-input",13),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.telefono=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](24,"ion-item"),g["\u0275\u0275elementStart"](25,"ion-input",14),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.CP=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](26,"ion-item"),g["\u0275\u0275elementStart"](27,"ion-input",15),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.poblacion=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](28,"ion-item"),g["\u0275\u0275elementStart"](29,"ion-input",16),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.password=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](30,"ion-item"),g["\u0275\u0275elementStart"](31,"ion-input",17),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.password2=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](32,"ion-button",18),g["\u0275\u0275text"](33," Registrate "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](34,"ion-button",19),g["\u0275\u0275text"](35," \xbfEstas ya registrado? "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275reference"](12);g["\u0275\u0275property"]("translucent",!0),g["\u0275\u0275advance"](11),g["\u0275\u0275property"]("ngModel",t.user.email),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngIf",!e.valid&&e.touched),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.name),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.lastname),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.CIF),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.calle),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.telefono),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.CP),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.poblacion),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.password),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.password2)}},directives:[i.r,i.L,i.h,i.z,i.K,i.o,i.i,o.k,o.e,o.f,i.u,i.t,i.W,o.j,o.h,o.d,o.g,r.k,i.g,i.U,a.h],styles:[".login-box[_ngcontent-%COMP%]{max-width:350px;margin:40px auto 0}.logo[_ngcontent-%COMP%]{margin:0 auto;height:30px}.if-logo[_ngcontent-%COMP%]{height:200px}.RP-Icon[_ngcontent-%COMP%]{width:100%;height:66px;bottom:90px;margin:50px auto 0 -2px}.login-button[_ngcontent-%COMP%]{width:90%;margin:20px auto 20px 5%}.login-register[_ngcontent-%COMP%]{width:90%;margin:0 auto 20px 5%}.code[_ngcontent-%COMP%]{margin-top:1vw;border-bottom:1px solid #ddd;padding:10px;color:#888}.app-version[_ngcontent-%COMP%]{color:#fff;font-size:18px;font-weight:300;text-align:center;margin-top:90px}"]}),e})()}];let u=(()=>{class e{}return e.\u0275mod=g["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=g["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.i.forChild(m)],a.i]}),e})(),p=(()=>{class e{}return e.\u0275mod=g["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=g["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.b,o.a,i.M,u]]}),e})()}}]);