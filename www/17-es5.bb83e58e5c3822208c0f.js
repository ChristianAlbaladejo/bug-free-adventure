!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{LsBH:function(n,r,o){"use strict";o.r(r),o.d(r,"ProductsPageModule",(function(){return O}));var i=o("ofXK"),a=o("3Pt+"),c=o("TEn/"),s=o("tyNb"),l=o("mrSG"),u=o("S3Px"),d=o("knE8"),m=o("AytR"),p=o("tk/3"),f=o("fXoL");function g(e,t){if(1&e){var n=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-icon",9),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](n),f["\u0275\u0275nextContext"]().gotoLogin()})),f["\u0275\u0275elementEnd"]()}}function h(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"ion-badge",10),f["\u0275\u0275text"](1),f["\u0275\u0275elementEnd"]()),2&e){var n=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](1),f["\u0275\u0275textInterpolate1"]("",null==n.cart?null:n.cart.length," ")}}function v(e,t){1&e&&f["\u0275\u0275element"](0,"img",18)}function k(e,t){if(1&e&&f["\u0275\u0275element"](0,"img",19),2&e){var n=f["\u0275\u0275nextContext"]().$implicit;f["\u0275\u0275propertyInterpolate"]("src",n.image,f["\u0275\u0275sanitizeUrl"])}}function y(e,t){if(1&e){var n=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-icon",22),f["\u0275\u0275listener"]("click",(function(){f["\u0275\u0275restoreView"](n);var e=f["\u0275\u0275nextContext"](2).$implicit;return f["\u0275\u0275nextContext"]().addFav(e)})),f["\u0275\u0275elementEnd"]()}}function x(e,t){if(1&e){var n=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-icon",23),f["\u0275\u0275listener"]("click",(function(){f["\u0275\u0275restoreView"](n);var e=f["\u0275\u0275nextContext"](2).$implicit;return f["\u0275\u0275nextContext"]().deleteFav(e)})),f["\u0275\u0275elementEnd"]()}}function C(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"div"),f["\u0275\u0275template"](1,y,1,0,"ion-icon",20),f["\u0275\u0275template"](2,x,1,0,"ion-icon",21),f["\u0275\u0275elementEnd"]()),2&e){var n=f["\u0275\u0275nextContext"]().$implicit,r=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",!r.checkFav(n)),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",r.checkFav(n))}}function I(e,t){if(1&e){var n=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"ion-card"),f["\u0275\u0275elementStart"](1,"ion-row"),f["\u0275\u0275elementStart"](2,"ion-col"),f["\u0275\u0275template"](3,v,1,0,"img",11),f["\u0275\u0275template"](4,k,1,1,"img",12),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](5,"ion-col",13),f["\u0275\u0275elementStart"](6,"h4"),f["\u0275\u0275elementStart"](7,"ion-card-title"),f["\u0275\u0275text"](8),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](9,"ion-card-subtitle"),f["\u0275\u0275text"](10),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](11,"ion-row"),f["\u0275\u0275element"](12,"ion-col"),f["\u0275\u0275elementStart"](13,"ion-col",14),f["\u0275\u0275elementStart"](14,"ion-button",15),f["\u0275\u0275listener"]("click",(function(){f["\u0275\u0275restoreView"](n);var e=t.$implicit;return f["\u0275\u0275nextContext"]().loadProduct(e)})),f["\u0275\u0275text"](15,"Ver mas"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](16,"ion-col",16),f["\u0275\u0275template"](17,C,3,2,"div",17),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,o=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",!r.image),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngIf",r.image),f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate"](r.name),f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate"](r.description),f["\u0275\u0275advance"](7),f["\u0275\u0275property"]("ngIf",o.productLike)}}var b,S,w,E=[{path:"",component:(b=function(){function n(t,r,o,i,a,c,s,l){e(this,n),this._productsService=t,this.activatedRoute=r,this.navCtrl=o,this.loadingController=i,this.alertController=a,this.toastController=c,this.modalController=s,this.http=l,this.cart=[],this.count=0,this.search=""}var r,o,i;return r=n,(o=[{key:"ngOnInit",value:function(){this.id=this.activatedRoute.snapshot.paramMap.get("id"),this.name=this.activatedRoute.snapshot.paramMap.get("family"),this.loadProducts()}},{key:"ionViewDidEnter",value:function(){this.ngOnInit()}},{key:"loadProducts",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create({message:"Cargando...",translucent:!0});case 2:return t=e.sent,e.next=5,t.present();case 5:for(this.user=localStorage.getItem("identity"),this.user=JSON.parse(this.user),this.cart=[],n=localStorage.getItem("cart"),n=JSON.parse(n),r=0;r<n.length;r++)this.cart.push(n[r]);this._productsService.getProductsById(this.id).subscribe((function(e){console.log(e),o.product=e,o.product.forEach((function(e){e.name=decodeURIComponent(e.name)})),o.user&&o._productsService.getFav(o.user[0].id).subscribe((function(e){o.productLike=e,o.productLike.forEach((function(e){e.name=decodeURIComponent(e.name)}))})),t.dismiss()}),(function(e){return Object(l.a)(o,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:"Error!",message:"Parece que tenemos problemas \ud83e\udd74",buttons:[{text:"Okay",handler:function(){n.ngOnInit()}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}}),e,this)})))}));case 12:case"end":return e.stop()}}),e,this)})))}},{key:"doRefresh",value:function(e){this.loadProducts(),e.target.complete()}},{key:"incrementQty",value:function(e){this.product[e].quantity+=1}},{key:"decrementQty",value:function(e){this.product[e].quantity>1&&(this.product[e].quantity-=1)}},{key:"filter",value:function(e){var t=this;""==this.search?this.loadProducts():this._productsService.filterByName(e.target.value,this.id).subscribe((function(e){t.product=e,t.product.forEach((function(e){e.name=decodeURIComponent(e.name)}))}),(function(e){}))}},{key:"loadProduct",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:d.a,swipeToClose:!0,componentProps:{product:e}});case 2:return(n=t.sent).onDidDismiss().then((function(e){r.ngOnInit()})),t.next=6,n.present();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"ifLogin",value:function(){return null==JSON.parse(localStorage.getItem("identity"))}},{key:"gotoCart",value:function(){this.ifLogin()?this.navCtrl.navigateForward("/login"):this.navCtrl.navigateForward("/cart")}},{key:"gotoLogin",value:function(){this.navCtrl.navigateForward("/cart")}},{key:"checkFav",value:function(e){for(var t=0;t<this.productLike.length;t++)if(e.id==this.productLike[t].productId)return!0;return!1}},{key:"addFav",value:function(e){this.productLike.push({productId:e.id,userId:this.user[0].id});var t={productId:e.id,userId:this.user[0].id},n=new p.c({"Content-Type":"application/json",Authorization:localStorage.getItem("token")});this.http.post(m.a.APIURL+"/addFavorite/",t,{headers:n}).subscribe((function(e){}),(function(e){console.log(e)}))}},{key:"deleteFav",value:function(e){for(var t=0;t<this.productLike.length;t++)e.id==this.productLike[t].productId&&this.productLike.splice(t,1);this._productsService.deleteFav(e.id,this.user[0].id).subscribe((function(e){}),(function(e){console.log(e)}))}}])&&t(r.prototype,o),i&&t(r,i),n}(),b.\u0275fac=function(e){return new(e||b)(f["\u0275\u0275directiveInject"](u.a),f["\u0275\u0275directiveInject"](s.a),f["\u0275\u0275directiveInject"](c.Q),f["\u0275\u0275directiveInject"](c.O),f["\u0275\u0275directiveInject"](c.b),f["\u0275\u0275directiveInject"](c.X),f["\u0275\u0275directiveInject"](c.P),f["\u0275\u0275directiveInject"](p.a))},b.\u0275cmp=f["\u0275\u0275defineComponent"]({type:b,selectors:[["app-products"]],features:[f["\u0275\u0275ProvidersFeature"]([u.a])],decls:16,vars:6,consts:[[3,"translucent"],["slot","start"],["slot","end",3,"click"],["slot","end","name","person-outline",3,"click",4,"ngIf"],["slot","icon-only","name","cart-outline"],["color","danger","style","position: absolute; right: -4px; top: -2px;",4,"ngIf"],["slot","fixed",3,"ionRefresh"],["animated","",3,"ngModel","ngModelChange","ionChange"],[4,"ngFor","ngForOf"],["slot","end","name","person-outline",3,"click"],["color","danger",2,"position","absolute","right","-4px","top","-2px"],["src","../../../assets/mug.jpg",4,"ngIf"],[3,"src",4,"ngIf"],["size","9"],[1,"center"],[3,"click"],[1,"heart"],[4,"ngIf"],["src","../../../assets/mug.jpg"],[3,"src"],["name","heart-outline",3,"click",4,"ngIf"],["color","danger","name","heart",3,"click",4,"ngIf"],["name","heart-outline",3,"click"],["color","danger","name","heart",3,"click"]],template:function(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"ion-header",0),f["\u0275\u0275elementStart"](1,"ion-toolbar"),f["\u0275\u0275elementStart"](2,"ion-buttons",1),f["\u0275\u0275element"](3,"ion-menu-button"),f["\u0275\u0275element"](4,"ion-back-button"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](5,"ion-title"),f["\u0275\u0275text"](6),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](7,"ion-buttons",2),f["\u0275\u0275listener"]("click",(function(){return t.gotoCart()})),f["\u0275\u0275template"](8,g,1,0,"ion-icon",3),f["\u0275\u0275element"](9,"ion-icon",4),f["\u0275\u0275template"](10,h,2,1,"ion-badge",5),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](11,"ion-content"),f["\u0275\u0275elementStart"](12,"ion-refresher",6),f["\u0275\u0275listener"]("ionRefresh",(function(e){return t.doRefresh(e)})),f["\u0275\u0275element"](13,"ion-refresher-content"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](14,"ion-searchbar",7),f["\u0275\u0275listener"]("ngModelChange",(function(e){return t.search=e}))("ionChange",(function(e){return t.filter(e)})),f["\u0275\u0275elementEnd"](),f["\u0275\u0275template"](15,I,18,5,"ion-card",8),f["\u0275\u0275elementEnd"]()),2&e&&(f["\u0275\u0275property"]("translucent",!0),f["\u0275\u0275advance"](6),f["\u0275\u0275textInterpolate"](t.name),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("ngIf",t.ifLogin()),f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("ngIf",t.cart),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("ngModel",t.search),f["\u0275\u0275advance"](1),f["\u0275\u0275property"]("ngForOf",t.product))},directives:[c.r,c.L,c.h,c.z,c.d,c.e,c.K,i.k,c.s,c.o,c.D,c.E,c.H,c.W,a.d,a.g,i.j,c.f,c.i,c.G,c.n,c.m,c.l,c.g],styles:[".center[_ngcontent-%COMP%]{text-align:center}img[_ngcontent-%COMP%]{margin-top:3rem}img[_ngcontent-%COMP%], ion-card[_ngcontent-%COMP%]{border-radius:5%}.picker[_ngcontent-%COMP%]{margin-top:1rem}ion-icon[_ngcontent-%COMP%]{zoom:1.2}ion-toolbar[_ngcontent-%COMP%]{--min-height:50px}.heart[_ngcontent-%COMP%]{text-align:center;zoom:2}"]}),b)}],P=((w=function t(){e(this,t)}).\u0275mod=f["\u0275\u0275defineNgModule"]({type:w}),w.\u0275inj=f["\u0275\u0275defineInjector"]({factory:function(e){return new(e||w)},imports:[[s.i.forChild(E)],s.i]}),w),O=((S=function t(){e(this,t)}).\u0275mod=f["\u0275\u0275defineNgModule"]({type:S}),S.\u0275inj=f["\u0275\u0275defineInjector"]({factory:function(e){return new(e||S)},imports:[[i.b,a.a,c.M,P]]}),S)}}])}();