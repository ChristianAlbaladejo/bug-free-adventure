!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{UrDz:function(n,r,o){"use strict";o.r(r),o.d(r,"RegisterPageModule",(function(){return C}));var i=o("ofXK"),a=o("3Pt+"),l=o("TEn/"),s=o("tyNb"),d=o("mrSG"),c=o("qfBg"),u=o("2hxB"),g=o("fXoL");function m(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"span"),g["\u0275\u0275element"](1,"br"),g["\u0275\u0275text"](2," El email es incorrecto"),g["\u0275\u0275elementEnd"]())}var p,h,f,M=[{path:"",component:(p=function(){function n(t,r,o,i,a){e(this,n),this.navCtrl=t,this._userService=r,this.loadingController=o,this.alertController=i,this.toastController=a,this.validateStreet=!1,this.formattedaddress=" ",this.options={componentRestrictions:{country:["ES"]}}}var r,o,i;return r=n,(o=[{key:"AddressChange",value:function(e){this.validateStreet=!1,console.log(this.validateStreet,e),"input"!=e&&(this.formattedaddress=e.formatted_address,this.getDistanciaMetros(e.geometry.location.lat(),e.geometry.location.lng(),37.804516,-.831246)?(this.formattedaddress="Podemos repartir",this.validateStreet=!0,this.user.calle=e.formatted_address):(this.formattedaddress="Lo sentimos no podemos repartir a esa direcci\xf3n",this.user.calle="",this.validateStreet=!1))}},{key:"ngOnInit",value:function(){this.user=new u.a("","","","","","","","","")}},{key:"register",value:function(){return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create({message:"Cargando...",translucent:!0});case 2:return t=e.sent,e.next=5,t.present();case 5:if(this.ifLogin&&localStorage.clear(),this.user.password!=this.password2){e.next=10;break}this._userService.register(this.user).subscribe((function(e){return Object(d.a)(n,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e),"El usuario ya existe!!"==e.message){t.next=5;break}this._userService.login(this.user).subscribe((function(e){n.identity=e.user,n.token=e.token,localStorage.setItem("identity",JSON.stringify(n.identity)),localStorage.setItem("token",n.token),n.loadingController.dismiss(),n.navCtrl.navigateForward("/home")}),(function(e){return Object(d.a)(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.error(e),this.loadingController.dismiss(),this.navCtrl.navigateForward("/login");case 1:case"end":return t.stop()}}),t,this)})))})),t.next=9;break;case 5:return this.loadingController.dismiss(),t.next=8,this.toastController.create({message:"Esta cuenta ya existe",duration:2e3,color:"danger"});case 8:t.sent.present();case 9:case"end":return t.stop()}}),t,this)})))}),(function(e){return Object(d.a)(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingController.dismiss(),e.next=3,this.toastController.create({message:"Error al registrar su cuenta",duration:2e3,color:"danger"});case 3:e.sent.present();case 4:case"end":return e.stop()}}),e,this)})))})),e.next=14;break;case 10:return e.next=12,this.toastController.create({message:"La contrase\xf1a no es la misma",duration:2e3,color:"danger"});case 12:e.sent.present(),this.loadingController.dismiss();case 14:case"end":return e.stop()}}),e,this)})))}},{key:"getDistanciaMetros",value:function(e,t,n,r){var o=function(e){return e*Math.PI/180},i=o(n-e),a=o(r-t),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o(e))*Math.cos(o(n))*Math.sin(a/2)*Math.sin(a/2),s=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6378.137;return console.log(s),s<=8}},{key:"ifLogin",value:function(){return null==JSON.parse(localStorage.getItem("identity"))}}])&&t(r.prototype,o),i&&t(r,i),n}(),p.\u0275fac=function(e){return new(e||p)(g["\u0275\u0275directiveInject"](l.Q),g["\u0275\u0275directiveInject"](c.a),g["\u0275\u0275directiveInject"](l.O),g["\u0275\u0275directiveInject"](l.b),g["\u0275\u0275directiveInject"](l.X))},p.\u0275cmp=g["\u0275\u0275defineComponent"]({type:p,selectors:[["app-register"]],features:[g["\u0275\u0275ProvidersFeature"]([c.a])],decls:36,vars:12,consts:[[3,"translucent"],["slot","start"],[1,"login"],["padding","",1,"login-box"],["novalidate","",3,"ngSubmit"],["registerForm","ngForm"],["placeholder","Email","name","email","type","email","required","","pattern","[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$",3,"ngModel","ngModelChange"],["email","ngModel"],[4,"ngIf"],["type","text","id","nombre","name","login","placeholder","Nombre","required","",3,"ngModel","ngModelChange"],["type","text","id","apellidos","name","login","placeholder","Apellidos","required","",3,"ngModel","ngModelChange"],["type","text","id","cif","name","login","placeholder","NIF","required","",3,"ngModel","ngModelChange"],["type","text","name","location","id","calle","aria-describedby","direccionHelp","placeholder","Calle","required","",3,"ngModel","ngModelChange","input","onAddressChange"],["type","text","id","tel\xe9fono","name","login","placeholder","Telefono","required","",3,"ngModel","ngModelChange"],["type","text","id","cp","name","login","placeholder","CP","required","",3,"ngModel","ngModelChange"],["type","text","id","poblacion","name","login","placeholder","Poblaci\xf3n","required","",3,"ngModel","ngModelChange"],["type","password","id","password","name","login","placeholder","Contrase\xf1a","required","",3,"ngModel","ngModelChange"],["type","password","id","password2","name","login","placeholder","Repite la contrase\xf1a","required","",3,"ngModel","ngModelChange"],["type","submit","color","primary","block","",1,"login-register"],["routerLink","../login","color","primary","block","",1,"login-register"]],template:function(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"ion-header",0),g["\u0275\u0275elementStart"](1,"ion-toolbar"),g["\u0275\u0275elementStart"](2,"ion-buttons",1),g["\u0275\u0275element"](3,"ion-menu-button"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](4,"ion-title"),g["\u0275\u0275text"](5,"Registrate"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](6,"ion-content",2),g["\u0275\u0275elementStart"](7,"ion-card",3),g["\u0275\u0275elementStart"](8,"form",4,5),g["\u0275\u0275listener"]("ngSubmit",(function(){return t.register()})),g["\u0275\u0275elementStart"](10,"ion-item"),g["\u0275\u0275elementStart"](11,"ion-input",6,7),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.email=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](13,m,3,0,"span",8),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](14,"ion-item"),g["\u0275\u0275elementStart"](15,"ion-input",9),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.name=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](16,"ion-item"),g["\u0275\u0275elementStart"](17,"ion-input",10),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.lastname=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](18,"ion-item"),g["\u0275\u0275elementStart"](19,"ion-input",11),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.CIF=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](20,"ion-item"),g["\u0275\u0275elementStart"](21,"ion-input",12),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.calle=e}))("input",(function(){return t.AddressChange("input")}))("onAddressChange",(function(e){return t.AddressChange(e)})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](22,"ion-item"),g["\u0275\u0275elementStart"](23,"ion-input",13),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.telefono=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](24,"ion-item"),g["\u0275\u0275elementStart"](25,"ion-input",14),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.CP=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](26,"ion-item"),g["\u0275\u0275elementStart"](27,"ion-input",15),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.poblacion=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](28,"ion-item"),g["\u0275\u0275elementStart"](29,"ion-input",16),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.password=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](30,"ion-item"),g["\u0275\u0275elementStart"](31,"ion-input",17),g["\u0275\u0275listener"]("ngModelChange",(function(e){return t.password2=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](32,"ion-button",18),g["\u0275\u0275text"](33," Registrate "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](34,"ion-button",19),g["\u0275\u0275text"](35," \xbfEstas ya registrado? "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){var n=g["\u0275\u0275reference"](12);g["\u0275\u0275property"]("translucent",!0),g["\u0275\u0275advance"](11),g["\u0275\u0275property"]("ngModel",t.user.email),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngIf",!n.valid&&n.touched),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.name),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.lastname),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.CIF),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.calle),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.telefono),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.CP),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.poblacion),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.user.password),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngModel",t.password2)}},directives:[l.r,l.L,l.h,l.z,l.K,l.o,l.i,a.k,a.e,a.f,l.u,l.t,l.W,a.j,a.h,a.d,a.g,i.k,l.g,l.U,s.h],styles:[".login-box[_ngcontent-%COMP%]{max-width:350px;margin:40px auto 0}.logo[_ngcontent-%COMP%]{margin:0 auto;height:30px}.if-logo[_ngcontent-%COMP%]{height:200px}.RP-Icon[_ngcontent-%COMP%]{width:100%;height:66px;bottom:90px;margin:50px auto 0 -2px}.login-button[_ngcontent-%COMP%]{width:90%;margin:20px auto 20px 5%}.login-register[_ngcontent-%COMP%]{width:90%;margin:0 auto 20px 5%}.code[_ngcontent-%COMP%]{margin-top:1vw;border-bottom:1px solid #ddd;padding:10px;color:#888}.app-version[_ngcontent-%COMP%]{color:#fff;font-size:18px;font-weight:300;text-align:center;margin-top:90px}"]}),p)}],v=((f=function t(){e(this,t)}).\u0275mod=g["\u0275\u0275defineNgModule"]({type:f}),f.\u0275inj=g["\u0275\u0275defineInjector"]({factory:function(e){return new(e||f)},imports:[[s.i.forChild(M)],s.i]}),f),C=((h=function t(){e(this,t)}).\u0275mod=g["\u0275\u0275defineNgModule"]({type:h}),h.\u0275inj=g["\u0275\u0275defineInjector"]({factory:function(e){return new(e||h)},imports:[[i.b,a.a,l.M,v]]}),h)}}])}();