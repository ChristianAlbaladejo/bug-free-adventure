(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{LsBH:function(e,t,n){"use strict";n.r(t),n.d(t,"ProductsPageModule",(function(){return b}));var o=n("ofXK"),i=n("3Pt+"),r=n("TEn/"),c=n("tyNb"),a=n("mrSG"),s=n("S3Px"),l=n("knE8"),d=n("AytR"),u=n("tk/3"),m=n("fXoL");function p(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"ion-icon",9),m["\u0275\u0275listener"]("click",(function(){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().gotoLogin()})),m["\u0275\u0275elementEnd"]()}}function h(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"ion-badge",10),m["\u0275\u0275text"](1),m["\u0275\u0275elementEnd"]()),2&e){const e=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"]("",null==e.cart?null:e.cart.length," ")}}function g(e,t){1&e&&m["\u0275\u0275element"](0,"img",18)}function f(e,t){if(1&e&&m["\u0275\u0275element"](0,"img",19),2&e){const e=m["\u0275\u0275nextContext"]().$implicit;m["\u0275\u0275propertyInterpolate"]("src",e.image,m["\u0275\u0275sanitizeUrl"])}}function v(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"ion-icon",22),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](e);const t=m["\u0275\u0275nextContext"](2).$implicit;return m["\u0275\u0275nextContext"]().addFav(t)})),m["\u0275\u0275elementEnd"]()}}function C(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"ion-icon",23),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](e);const t=m["\u0275\u0275nextContext"](2).$implicit;return m["\u0275\u0275nextContext"]().deleteFav(t)})),m["\u0275\u0275elementEnd"]()}}function I(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div"),m["\u0275\u0275template"](1,v,1,0,"ion-icon",20),m["\u0275\u0275template"](2,C,1,0,"ion-icon",21),m["\u0275\u0275elementEnd"]()),2&e){const e=m["\u0275\u0275nextContext"]().$implicit,t=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",!t.checkFav(e)),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",t.checkFav(e))}}function x(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"ion-card"),m["\u0275\u0275elementStart"](1,"ion-row"),m["\u0275\u0275elementStart"](2,"ion-col"),m["\u0275\u0275template"](3,g,1,0,"img",11),m["\u0275\u0275template"](4,f,1,1,"img",12),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](5,"ion-col",13),m["\u0275\u0275elementStart"](6,"h4"),m["\u0275\u0275elementStart"](7,"ion-card-title"),m["\u0275\u0275text"](8),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](9,"ion-card-subtitle"),m["\u0275\u0275text"](10),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](11,"ion-row"),m["\u0275\u0275element"](12,"ion-col"),m["\u0275\u0275elementStart"](13,"ion-col",14),m["\u0275\u0275elementStart"](14,"ion-button",15),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](e);const n=t.$implicit;return m["\u0275\u0275nextContext"]().loadProduct(n)})),m["\u0275\u0275text"](15,"Ver mas"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](16,"ion-col",16),m["\u0275\u0275template"](17,I,3,2,"div",17),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](3),m["\u0275\u0275property"]("ngIf",!e.image),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",e.image),m["\u0275\u0275advance"](4),m["\u0275\u0275textInterpolate"](e.name),m["\u0275\u0275advance"](2),m["\u0275\u0275textInterpolate"](e.description),m["\u0275\u0275advance"](7),m["\u0275\u0275property"]("ngIf",n.productLike)}}const y=[{path:"",component:(()=>{class e{constructor(e,t,n,o,i,r,c,a){this._productsService=e,this.activatedRoute=t,this.navCtrl=n,this.loadingController=o,this.alertController=i,this.toastController=r,this.modalController=c,this.http=a,this.cart=[],this.count=0,this.search=""}ngOnInit(){this.id=this.activatedRoute.snapshot.paramMap.get("id"),this.name=this.activatedRoute.snapshot.paramMap.get("family"),this.loadProducts()}ionViewDidEnter(){this.ngOnInit()}loadProducts(){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.loadingController.create({message:"Cargando...",translucent:!0});yield e.present(),this.user=localStorage.getItem("identity"),this.user=JSON.parse(this.user),this.cart=[];let t=localStorage.getItem("cart");t=JSON.parse(t);for(let n=0;n<t.length;n++)this.cart.push(t[n]);this._productsService.getProductsById(this.id).subscribe(t=>{console.log(t),this.product=t,this.product.forEach(e=>{e.name=decodeURIComponent(e.name)}),this.user&&this._productsService.getFav(this.user[0].id).subscribe(e=>{this.productLike=e,this.productLike.forEach(e=>{e.name=decodeURIComponent(e.name)})}),e.dismiss()},e=>Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({header:"Error!",message:"Parece que tenemos problemas \u{1f974}",buttons:[{text:"Okay",handler:()=>{this.ngOnInit()}}]});yield e.present()})))}))}doRefresh(e){this.loadProducts(),e.target.complete()}incrementQty(e){this.product[e].quantity+=1}decrementQty(e){this.product[e].quantity>1&&(this.product[e].quantity-=1)}filter(e){""==this.search?this.loadProducts():this._productsService.filterByName(e.target.value,this.id).subscribe(e=>{this.product=e,this.product.forEach(e=>{e.name=decodeURIComponent(e.name)})},e=>{})}loadProduct(e){return Object(a.a)(this,void 0,void 0,(function*(){const t=yield this.modalController.create({component:l.a,swipeToClose:!0,componentProps:{product:e}});return t.onDidDismiss().then(e=>{this.ngOnInit()}),yield t.present()}))}ifLogin(){return null==JSON.parse(localStorage.getItem("identity"))}gotoCart(){this.ifLogin()?this.navCtrl.navigateForward("/login"):this.navCtrl.navigateForward("/cart")}gotoLogin(){this.navCtrl.navigateForward("/cart")}checkFav(e){for(let t=0;t<this.productLike.length;t++)if(e.id==this.productLike[t].productId)return!0;return!1}addFav(e){this.productLike.push({productId:e.id,userId:this.user[0].id});var t={productId:e.id,userId:this.user[0].id};let n=new u.c({"Content-Type":"application/json",Authorization:localStorage.getItem("token")});this.http.post(d.a.APIURL+"/addFavorite/",t,{headers:n}).subscribe(e=>{},e=>{console.log(e)})}deleteFav(e){for(let t=0;t<this.productLike.length;t++)e.id==this.productLike[t].productId&&this.productLike.splice(t,1);this._productsService.deleteFav(e.id,this.user[0].id).subscribe(e=>{},e=>{console.log(e)})}}return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](s.a),m["\u0275\u0275directiveInject"](c.a),m["\u0275\u0275directiveInject"](r.Q),m["\u0275\u0275directiveInject"](r.O),m["\u0275\u0275directiveInject"](r.b),m["\u0275\u0275directiveInject"](r.X),m["\u0275\u0275directiveInject"](r.P),m["\u0275\u0275directiveInject"](u.a))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-products"]],features:[m["\u0275\u0275ProvidersFeature"]([s.a])],decls:16,vars:6,consts:[[3,"translucent"],["slot","start"],["slot","end",3,"click"],["slot","end","name","person-outline",3,"click",4,"ngIf"],["slot","icon-only","name","cart-outline"],["color","danger","style","position: absolute; right: -4px; top: -2px;",4,"ngIf"],["slot","fixed",3,"ionRefresh"],["animated","",3,"ngModel","ngModelChange","ionChange"],[4,"ngFor","ngForOf"],["slot","end","name","person-outline",3,"click"],["color","danger",2,"position","absolute","right","-4px","top","-2px"],["src","../../../assets/mug.jpg",4,"ngIf"],[3,"src",4,"ngIf"],["size","9"],[1,"center"],[3,"click"],[1,"heart"],[4,"ngIf"],["src","../../../assets/mug.jpg"],[3,"src"],["name","heart-outline",3,"click",4,"ngIf"],["color","danger","name","heart",3,"click",4,"ngIf"],["name","heart-outline",3,"click"],["color","danger","name","heart",3,"click"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"ion-header",0),m["\u0275\u0275elementStart"](1,"ion-toolbar"),m["\u0275\u0275elementStart"](2,"ion-buttons",1),m["\u0275\u0275element"](3,"ion-menu-button"),m["\u0275\u0275element"](4,"ion-back-button"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](5,"ion-title"),m["\u0275\u0275text"](6),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](7,"ion-buttons",2),m["\u0275\u0275listener"]("click",(function(){return t.gotoCart()})),m["\u0275\u0275template"](8,p,1,0,"ion-icon",3),m["\u0275\u0275element"](9,"ion-icon",4),m["\u0275\u0275template"](10,h,2,1,"ion-badge",5),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](11,"ion-content"),m["\u0275\u0275elementStart"](12,"ion-refresher",6),m["\u0275\u0275listener"]("ionRefresh",(function(e){return t.doRefresh(e)})),m["\u0275\u0275element"](13,"ion-refresher-content"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](14,"ion-searchbar",7),m["\u0275\u0275listener"]("ngModelChange",(function(e){return t.search=e}))("ionChange",(function(e){return t.filter(e)})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](15,x,18,5,"ion-card",8),m["\u0275\u0275elementEnd"]()),2&e&&(m["\u0275\u0275property"]("translucent",!0),m["\u0275\u0275advance"](6),m["\u0275\u0275textInterpolate"](t.name),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngIf",t.ifLogin()),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngIf",t.cart),m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("ngModel",t.search),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngForOf",t.product))},directives:[r.r,r.L,r.h,r.z,r.d,r.e,r.K,o.k,r.s,r.o,r.D,r.E,r.H,r.W,i.d,i.g,o.j,r.f,r.i,r.G,r.n,r.m,r.l,r.g],styles:[".center[_ngcontent-%COMP%]{text-align:center}img[_ngcontent-%COMP%]{margin-top:3rem}img[_ngcontent-%COMP%], ion-card[_ngcontent-%COMP%]{border-radius:5%}.picker[_ngcontent-%COMP%]{margin-top:1rem}ion-icon[_ngcontent-%COMP%]{zoom:1.2}ion-toolbar[_ngcontent-%COMP%]{--min-height:50px}.heart[_ngcontent-%COMP%]{text-align:center;zoom:2}"]}),e})()}];let S=(()=>{class e{}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[c.i.forChild(y)],c.i]}),e})(),b=(()=>{class e{}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.b,i.a,r.M,S]]}),e})()}}]);