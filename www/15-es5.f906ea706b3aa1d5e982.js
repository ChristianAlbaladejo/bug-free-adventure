!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{YiOL:function(n,r,o){"use strict";o.r(r),o.d(r,"OrdersPageModule",(function(){return x}));var i=o("ofXK"),a=o("3Pt+"),s=o("TEn/"),c=o("tyNb"),l=o("mrSG"),d=o("S3Px"),u=o("fXoL");function p(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"ion-icon",7),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().gotoLogin()})),u["\u0275\u0275elementEnd"]()}}function f(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"p"),u["\u0275\u0275text"](1),u["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate2"]("",n.name," x",n.quantity,"")}}function m(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"ion-item",9),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](n);var e=t.$implicit;return u["\u0275\u0275nextContext"](2).tab(e.orderLines)})),u["\u0275\u0275elementStart"](1,"ion-label"),u["\u0275\u0275elementStart"](2,"h2"),u["\u0275\u0275text"](3),u["\u0275\u0275pipe"](4,"date"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](5,f,2,2,"p",10),u["\u0275\u0275elementStart"](6,"h3"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"number"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit;u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("Pedido del dia: ",u["\u0275\u0275pipeBind1"](4,3,r.date),""),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngForOf",r.orderLines),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"]("",u["\u0275\u0275pipeBind2"](8,5,r.grossAmount,"1.2-2")," \u20ac")}}function g(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"ion-list"),u["\u0275\u0275template"](1,m,9,8,"ion-item",8),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngForOf",n.orders)}}var h,v,S,y=[{path:"",component:(h=function(){function n(t,r,o,i,a){e(this,n),this._productsService=t,this.navCtrl=r,this.loadingController=o,this.actionSheetController=i,this.toastController=a,this.orders=[],this.cart=[],this.user=localStorage.getItem("identity"),this.user=JSON.parse(this.user)}var r,o,i;return r=n,(o=[{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.load(),this.cart=[],t=localStorage.getItem("cart"),t=JSON.parse(t),n=0;n<t.length;n++)this.cart.push(t[n]);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"ionViewDidEnter",value:function(){this.ngOnInit()}},{key:"load",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create({message:"Cargando...",translucent:!0});case 2:return t=e.sent,e.next=5,t.present();case 5:this.orders=[],this._productsService.getSalesOrders(this.user[0].id).subscribe((function(e){n.orders=e;for(var t=0;t<n.orders.length;t++)n.orders[t].orderLines=n.orders[t].orderLines.replace(/'/g,'"'),n.orders[t].orderLines=JSON.parse(n.orders[t].orderLines);n.orders=n.orders.reverse(),n.loadingController.dismiss()}),(function(e){console.log(e),n.loadingController.dismiss()}));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"addToCart",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,i,a,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(console.log(e.length),n=!1,r=[],o=localStorage.getItem("cart"),r=JSON.parse(o),i=0;i<r.length;i++)for(a=function(t){r[i].id==e[t].id?(r[i].quantity+=e[t].quantity,n=!0):r.some((function(n){return n.id===e[t].id}))||r.push(e[t])},s=0;s<e.length;s++)a(s);if(n)localStorage.setItem("cart",JSON.stringify(r));else{for(c=0;c<e.length;c++)this.cart.push(e[c]);localStorage.setItem("cart",JSON.stringify(this.cart))}return t.next=7,this.toastController.create({message:"Pedido a\xf1adido",duration:2e3,color:"success"});case 7:t.sent.present(),this.navCtrl.navigateForward("/home");case 9:case"end":return t.stop()}}),t,this)})))}},{key:"ifLogin",value:function(){return null==JSON.parse(localStorage.getItem("identity"))}},{key:"gotoCart",value:function(){this.ifLogin()?this.navCtrl.navigateForward("/login"):this.navCtrl.navigateForward("/cart")}},{key:"tab",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.actionSheetController.create({header:"Realizar pedido",buttons:[{text:"repetir pedido",icon:"repeat-outline",handler:function(){r.addToCart(e)}},{text:"Cancel",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"gotoLogin",value:function(){this.navCtrl.navigateForward("/cart")}}])&&t(r.prototype,o),i&&t(r,i),n}(),h.\u0275fac=function(e){return new(e||h)(u["\u0275\u0275directiveInject"](d.a),u["\u0275\u0275directiveInject"](s.Q),u["\u0275\u0275directiveInject"](s.O),u["\u0275\u0275directiveInject"](s.a),u["\u0275\u0275directiveInject"](s.X))},h.\u0275cmp=u["\u0275\u0275defineComponent"]({type:h,selectors:[["app-orders"]],features:[u["\u0275\u0275ProvidersFeature"]([d.a])],decls:14,vars:4,consts:[[3,"translucent"],["slot","start"],["slot","end",3,"click"],["slot","end","name","person-outline",3,"click",4,"ngIf"],["slot","icon-only","name","cart-outline"],["color","danger",2,"position","absolute","right","-4px","top","-2px"],[4,"ngIf"],["slot","end","name","person-outline",3,"click"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"ion-header",0),u["\u0275\u0275elementStart"](1,"ion-toolbar"),u["\u0275\u0275elementStart"](2,"ion-buttons",1),u["\u0275\u0275element"](3,"ion-menu-button"),u["\u0275\u0275element"](4,"ion-back-button"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"ion-title"),u["\u0275\u0275text"](6,"Tus pedidos"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](7,"ion-buttons",2),u["\u0275\u0275listener"]("click",(function(){return t.gotoCart()})),u["\u0275\u0275template"](8,p,1,0,"ion-icon",3),u["\u0275\u0275element"](9,"ion-icon",4),u["\u0275\u0275elementStart"](10,"ion-badge",5),u["\u0275\u0275text"](11),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](12,"ion-content"),u["\u0275\u0275template"](13,g,2,1,"ion-list",6),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275property"]("translucent",!0),u["\u0275\u0275advance"](8),u["\u0275\u0275property"]("ngIf",t.ifLogin()),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](null==t.cart?null:t.cart.length),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",t.orders))},directives:[s.r,s.L,s.h,s.z,s.d,s.e,s.K,i.k,s.s,s.f,s.o,s.w,i.j,s.u,s.v],pipes:[i.d,i.e],styles:["ion-icon[_ngcontent-%COMP%]{zoom:1.2}"]}),h)}],w=((S=function t(){e(this,t)}).\u0275mod=u["\u0275\u0275defineNgModule"]({type:S}),S.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||S)},imports:[[c.i.forChild(y)],c.i]}),S),x=((v=function t(){e(this,t)}).\u0275mod=u["\u0275\u0275defineNgModule"]({type:v}),v.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||v)},imports:[[i.b,a.a,s.M,w]]}),v)}}])}();